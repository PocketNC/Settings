; An approximate tool length must be known at this point
; and must be active with G43 (see find-nominal-probe-length-offset).
; B should be mostly zeroed already

o<align-b-with-x> sub

o100 if [ #<_tool_offset> NE 1 ]
  (abort,You must have a tool length offset in place)
o100 endif


o<push_feature_set> call
M70

G20 
G90 G94 G40 G17 G91.1
M429

G53 G0 Z0

;F#<_ini[TOOL_PROBE]FEED_TRAVEL>
;G90 G1 Y1.75 X1.75
;G90 G1 Z1.959
;o<add-points-probe-line> call [-1] [0] [0] [0] [0] [-1] [2] [3.5] [0.51] [#<_ini[TOOL_PROBE]FEED_TRAVEL> ] [#<_ini[TOOL_PROBE]FEED_FAST> ] [#<_ini[TOOL_PROBE]FEED_BACK> ] [ #<_ini[TOOL_PROBE]FEED_SLOW> ] [1]
;G91 G0 B[ -#<_penta_line_angle_about_y> ]
;o<clear_points> call

F#<_ini[TOOL_PROBE]FEED_TRAVEL>
G90 G1 Y1.75 X1.75
G90 G1 Z1.659

o<add-points-probe-line> call [-1] [0] [0] [0] [0] [-1] [10] [3.5] [0.11] [#<_ini[TOOL_PROBE]FEED_TRAVEL> ] [#<_ini[TOOL_PROBE]FEED_FAST> ] [#<_ini[TOOL_PROBE]FEED_BACK> ] [ #<_ini[TOOL_PROBE]FEED_SLOW> ] [1]

G53 G0 Z0

G91 G0 B[ -#<_penta_line_angle_about_y> ]

;(logappend,b-offsets.txt)
;(log,#<_penta_line_angle_about_y>)
;(logclose)

M72
o<pop_feature_set> call

o<align-b-with-x> endsub
