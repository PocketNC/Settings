;M428 by remap: select TCP (xyzac,xyzbc)
o<428remap>sub
  #<SWITCHKINS_PIN> = 3  ; set N as required: motion.analog-out-0N
  #<kinstype> = 1        ; xyzac,xyzbc

o1 if [exists [#<_hal[motion.switchkins-type]>]]
o1 else
     M66  E0 L0                           ; force synch
     (abort,M428:Missing [RS274NGC]FEATURE==8)
o1 endif

   M68  E#<SWITCHKINS_PIN> Q#<kinstype> ; set kinstype value
   M66  E0 L0                           ; force synch

o2 if [[#<_task> EQ 1] AND [#<_hal[motion.switchkins-type]> NE #<kinstype>]]
     M66  E0 L0
     (abort,M428: Wrong motion.switchkins-type or missing hal net to analog-out-0x)
o2 else
o2 endif

o<428remap>endsub
M2
