o<probe-relative> sub

M70

G90
G61.1

#<startX> = #5420
#<startY> = #5421
#<startZ> = #5422

#<cmdX> = [ #<startX>+#1 ]
#<cmdY> = [ #<startY>+#2 ]
#<cmdZ> = [ #<startZ>+#3 ]

#<feedFast> = #4
#<feedBack> = #5
#<feedSlow> = #6

G4 P.1
G38.2 F#<feedFast> X[ #<cmdX> ] Y[ #<cmdY> ] Z[ #<cmdZ> ]

#<fastTrippedX> = #5061
#<fastTrippedY> = #5062
#<fastTrippedZ> = #5063

G4 P.1
G38.4 F#<feedBack> X[ #<startX> ] Y[ #<startY> ] Z[ #<startZ> ]
G4 P.1
G38.2 F#<feedSlow> X[ #<fastTrippedX> ] Y[ #<fastTrippedY> ] Z[ #<fastTrippedZ> ]
G4 P.1

o<set_probe_direction> call [#1] [#2] [#3]

; TODO - account for TCPC

#<_probedG5X_X> = [ #5061 + #<_probe_compensation_x> ]
#<_probedG5X_Y> = [ #5062 + #<_probe_compensation_y> ]
#<_probedG5X_Z> = [ #5063 + #<_probe_compensation_z> ]

#<_probedRelativeX> = [ #5061 + #<_probe_compensation_x> - #<startX> ]
#<_probedRelativeY> = [ #5062 + #<_probe_compensation_y> - #<startY> ]
#<_probedRelativeZ> = [ #5063 + #<_probe_compensation_y> - #<startZ> ]

G1 F#<feedFast> X[ #<startX> ] Y[ #<startY> ] Z[ #<startZ> ]

M72
o<probe-relative> endsub

